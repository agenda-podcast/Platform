module_id: 9SD
name: demo_derive_queries
version: 0.2.0
kind: transform
description: "Demo transform module: derive search queries from a seed topic."

# Module-level dependencies are not supported. All wiring is expressed in workorders via steps/bindings.

supports_downloadable_artifacts: true
produces_manifest: true

cache:
  enabled: true
  retention_default: 1w
  key_inputs:
    - topic
    - language
    - freshness_days
    - summary_style

ports:
  inputs:
    port:
      - id: topic
        type: string
        required: true
        format: text/plain
        case_sensitive: false
        schema:
          minLength: 1
          maxLength: 512
        description: "Seed topic used to derive a set of Google search queries."
      - id: language
        type: string
        required: false
        default: "en"
        format: text/plain
        case_sensitive: false
        schema:
          minLength: 1
          maxLength: 32
        description: "Language hint used for derived queries."
      - id: freshness_days
        type: string
        required: false
        default: "7"
        format: text/plain
        case_sensitive: false
        schema:
          pattern: "^\\d+$"
          minLength: 1
          maxLength: 4
        description: "Freshness window for query wording (used only in text generation)."
    limited_port:
      - id: summary_style
        type: string
        required: false
        default: "headlines"
        format: text/plain
        case_sensitive: false
        schema:
          minLength: 0
          maxLength: 64
        description: "Platform-only tuning knob; not tenant-editable."
  outputs:
    port:
      - id: derived_queries
        type: file
        path: derived_queries.txt
        format: text/plain
        description: "One search query per line."
      - id: report
        type: file
        path: report.json
        format: application/json
        description: "Structured report about derived queries."
    limited_port: []

deliverables:
  port:
    - deliverable_id: tenant_outputs
      description: "Tenant-visible outputs."
      outputs: [derived_queries, report]
  limited_port: []
